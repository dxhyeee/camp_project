import pandas as pd
import random

# 1. 랜덤 요소를 위한 기초 데이터군 (이름 제외)
locations = ['서울 강남구', '부산 해운대구', '대구 수성구', '인천 미추홀구', '광주 북구', '울산 남구', '대전 서구', '제주 제주시']
evidences = ['CCTV 녹화 영상', '목격자 진술', '피고인의 자백', '휴대폰 포렌식 결과', '현장 DNA 채취 기록', '피해자의 통장 내역', '블랙박스 영상', '금융거래 정보 조회 결과']
mitigations = ['초범인 점', '피해자와 합의하여 처벌을 원치 않는 점', '진지하게 반성하고 있는 점', '사회적 유대관계가 분명하여 재범 우려가 적은 점']
aggravations = ['누범 기간 중 범행을 저지른 점', '동종 전과가 다수 존재하여 상습성이 인정되는 점', '피해 회복 노력이 전혀 없는 점', '범행 수법이 대단히 치밀하고 대담한 점']

# 2. 사건 종류별 상세 시나리오 조각들
scenarios = {
    '사기': ["투자금 명목으로 고액을 편취함", "조직적 보이스피싱 범죄에 가담함", "중고물품 거래 사이트에서 다수를 기망함", "정부 지원금을 허위로 수령함"],
    '절도': ["야간에 빈집에 침입하여 금품을 훔침", "주차된 차량의 창문을 부수고 귀중품을 절취함", "무인 점포의 금고를 파손하고 현금을 가져감", "혼잡한 지하철 내에서 타인의 소지품을 소매치기함"],
    '마약': ["텔레그램 익명 채널을 통해 마약류를 구매함", "주택가 화단 등에 마약을 숨기는 던지기 수법을 사용함", "자신의 주거지에서 상습적으로 투약함", "마약류 유통 과정에서 전달책 역할을 수행함"],
    '횡령': ["법인 카드를 개인적인 용도로 수백 차례 유용함", "거래처에 지급할 대금을 자신의 차명 계좌로 이체함", "회사의 자재를 몰래 빼돌려 처분함", "회계 장부를 조작하여 비자금을 조성함"],
    '폭행': ["술자리에서 시비가 붙어 피해자를 무차별 폭행함", "층간 소음 문제로 갈등을 빚던 중 흉기를 휘두름", "보복 운전 중 차에서 내려 피해자에게 물리력을 행사함", "길을 가던 행인에게 이유 없이 시비를 걸어 타격을 가함"],
    '음주운전': ["음주 단속을 피하기 위해 인도로 돌진함", "술에 취해 주차된 차량 3대를 연쇄적으로 추돌함", "중앙선을 침범하여 마주 오던 차량에 큰 피해를 입힘", "면허 취소 수치임에도 장거리 운전을 강행함"],
    '명예훼손': ["허위 사실을 인터넷 커뮤니티에 유포함", "유명인에 대한 악성 댓글을 상습적으로 게시함", "익명 SNS를 통해 특정인의 신상을 비방함", "단체 채팅방 내에서 특정인에 대한 허위 루머를 퍼뜨림"],
    '교통사고': ["어린이 보호구역 내에서 과속 중 보행자를 충돌함", "신호를 위반하여 교차로에서 대형 사고를 일으킴", "졸음 운전으로 가드레일을 들이받고 보행자에게 상해를 입힘", "무단 횡단자를 발견하지 못하고 충격하여 중상을 입힘"],
    '공무집행방해': ["음주 측정 요구를 거부하며 경찰관을 폭행함", "관공서에서 난동을 피우며 집기를 파손함", "정당한 공무 수행 중인 공무원에게 위협적인 태도를 보임", "지구대 내에서 소란을 피우며 공무를 방해함"],
    '강제추행': ["지하철 전동차 내에서 피해자에게 신체를 밀착함", "엘리베이터라는 밀폐된 공간에서 기습적으로 신체를 만짐", "강압적으로 피해자의 의사에 반하는 신체 접촉을 시도함", "어두운 골목길에서 갑작스럽게 추행을 가함"]
}

def generate_dynamic_fact(category, case_id):
    loc = random.choice(locations)
    scenario = random.choice(scenarios[category])
    evid = random.sample(evidences, 2)
    factor = random.choice(mitigations if random.random() > 0.5 else aggravations)
    date = f"2025년 {random.randint(1, 12)}월 {random.randint(1, 28)}일"
    amt = f"{random.randint(500, 9500)}만 원"

    # 400자 이상 확보를 위한 구체적인 법률 문장 조합
    intro = f"[{category} 사건 - {case_id}] 피고인은 {date}경 {loc} 인근에서 범행을 저질렀습니다. "
    body = f"사건의 구체적인 경위를 살펴보면, 피고인은 {scenario}의 방식으로 약 {amt} 상당의 피해를 야기하였으며, 이 과정에서 타인의 권리를 심각하게 침해하고 사회적 질서를 교란하였습니다. "
    process = f"수사 기관은 현장 {evid[0]}와(과) {evid[1]}를(을) 결정적인 증거로 확보하여 피고인의 공소 사실을 입증하였습니다. 피고인은 범행 초기에는 사실 관계를 부인하였으나, 수집된 증거 자료들이 제시되자 비로소 자신의 행위를 일부 인정하는 태도를 보였습니다. "
    analysis = f"재판부는 피고인의 행위가 형법상 {category}죄의 구성요건을 충분히 만족한다고 판단하였습니다. 특히 해당 범죄는 선량한 시민들에게 불안감을 조성하고 사회적 신뢰를 훼손한다는 점에서 엄중한 책임 추궁이 필요합니다. "
    closing = f"최종 양형에 있어서는 {factor}를(을) 핵심적인 근거로 삼았습니다. "
    
    # 판결 결과
    outcome = f"징역 {random.randint(1, 4)}년 또는 벌금 {random.randint(1000, 5000)}만 원에 처한다."
    if "무죄" in factor: outcome = "범죄의 증명이 부족하거나 고의성이 입증되지 않아 무죄를 선고한다."

    full_text = intro + body + process + analysis + closing + f"[최종 판결: {outcome}]"
    return full_text

# 3. 1,200개 데이터 생성
data = []
cats = list(scenarios.keys())
for i in range(1200):
    cat = cats[i % 10]
    data.append({
        'Case_ID': f"2026-LAW-{i+1:04d}",
        'Category': cat,
        'Facts': generate_dynamic_fact(cat, f"2026-LAW-{i+1:04d}")
    })

# CSV 저장
df = pd.DataFrame(data)
df.to_csv('legal_data_final.csv', index=False, encoding='utf-8-sig')
print(f"✅ {len(df)}개의 판례 데이터 생성 완료. (평균 글자 수: {df['Facts'].str.len().mean():.1f}자)")
